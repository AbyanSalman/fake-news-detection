<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fake News Detection</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen py-8 px-4">
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Fake News Detector</h1>
            <p class="text-gray-600">Machine Learning Project - Logistic Regression + TF-IDF</p>
            <p class="text-sm text-gray-500 mt-1">Muhamad Abyan Avriliansyah Salman (2441049)</p>
        </div>

        <!-- Main Card -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6">Analyze News Article</h2>
            
            <!-- Form -->
            <form id="newsForm" class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-medium mb-2">
                        Enter News Text
                    </label>
                    <textarea
                        id="news_text"
                        rows="6"
                        required
                        placeholder="Paste your news article here (minimum 10 characters)..."
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                    ></textarea>
                    <span id="charCount" class="text-sm text-gray-500">0 characters</span>
                </div>

                <button
                    type="submit"
                    id="submitBtn"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-200"
                >
                    Analyze News
                </button>
            </form>

            <!-- Examples -->
            <div class="mt-4 flex gap-3">
                <button onclick="loadExample('real')" class="flex-1 text-sm py-2 px-4 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg border border-green-200 transition">
                    Real News Example
                </button>
                <button onclick="loadExample('fake')" class="flex-1 text-sm py-2 px-4 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg border border-red-200 transition">
                    Fake News Example
                </button>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden bg-white rounded-xl shadow-lg p-8 text-center">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"></div>
            <p class="mt-4 text-gray-600">Analyzing...</p>
        </div>

        <!-- Result -->
        <div id="result" class="hidden"></div>

        <!-- API Info -->
        <div class="bg-white rounded-xl shadow-lg p-6 mt-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-3">API Information</h3>
            <div class="bg-gray-50 rounded-lg p-4 font-mono text-sm space-y-2">
                <div>
                    <span class="text-gray-600">Endpoint:</span>
                    <span class="text-blue-600 font-semibold">POST http://localhost:8000/predict</span>
                </div>
                <div>
                    <span class="text-gray-600">Request:</span>
                    <code class="text-gray-800">{"text": "your news article..."}</code>
                </div>
                <div>
                    <span class="text-gray-600">Response:</span>
                    <code class="text-gray-800">{"prediction": "FAKE/REAL", "confidence": 95.2}</code>
                </div>
            </div>
            <a href="http://localhost:8000/docs" target="_blank" class="inline-block mt-4 text-blue-600 hover:text-blue-800 font-medium">
                View Interactive API Docs â†’
            </a>
        </div>
    </div>

    <script>
        const form = document.getElementById('newsForm');
        const textarea = document.getElementById('news_text');
        const charCount = document.getElementById('charCount');
        const loading = document.getElementById('loading');
        const result = document.getElementById('result');
        const submitBtn = document.getElementById('submitBtn');

        // Character counter
        textarea.addEventListener('input', () => {
            charCount.textContent = textarea.value.length + ' characters';
        });

        // Form submission
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const text = textarea.value.trim();
            if (text.length < 10) {
                alert('Please enter at least 10 characters');
                return;
            }

            // Show loading
            loading.classList.remove('hidden');
            result.classList.add('hidden');
            submitBtn.disabled = true;

            try {
                const response = await fetch('http://localhost:8000/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text })
                });

                const data = await response.json();

                if (data.error) {
                    showError(data.error);
                } else {
                    showResult(data);
                }
            } catch (error) {
                showError('Cannot connect to API. Make sure FastAPI is running on http://localhost:8000');
            } finally {
                loading.classList.add('hidden');
                submitBtn.disabled = false;
            }
        });

        function showResult(data) {
            const isFake = data.prediction === 'FAKE';
            const bgColor = isFake ? 'bg-red-50 border-red-200' : 'bg-green-50 border-green-200';
            const textColor = isFake ? 'text-red-800' : 'text-green-800';

            result.innerHTML = `
                <div class="${bgColor} border-2 rounded-xl p-8">
                    <div class="flex items-center gap-4 mb-6">
                        <div>
                            <h3 class="text-3xl font-bold ${textColor}">${data.prediction} NEWS</h3>
                            <p class="text-lg text-gray-700 mt-1">Confidence: ${data.confidence}%</p>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg p-6 space-y-4">
                        <h4 class="font-semibold text-gray-800 mb-3">Probability Distribution</h4>
                        
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-gray-700">Fake News</span>
                                <span class="font-semibold text-red-600">${data.probabilities.fake}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-red-500 h-3 rounded-full transition-all duration-500" style="width: ${data.probabilities.fake}%"></div>
                            </div>
                        </div>

                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span class="text-gray-700">Real News</span>
                                <span class="font-semibold text-green-600">${data.probabilities.real}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="bg-green-500 h-3 rounded-full transition-all duration-500" style="width: ${data.probabilities.real}%"></div>
                            </div>
                        </div>
                    </div>

                    ${data.confidence < 70 ? `
                    <div class="mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <p class="text-yellow-800 text-sm">
                            Low confidence: model is uncertain. Verify from other sources.
                        </p>
                    </div>
                    ` : ''}
                </div>
            `;
            result.classList.remove('hidden');
        }

        function showError(message) {
            result.innerHTML = `
                <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6">
                    <div class="flex items-center gap-3">
                        <div>
                            <h3 class="text-xl font-bold text-red-800">Error</h3>
                            <p class="text-red-700 mt-1">${message}</p>
                        </div>
                    </div>
                </div>
            `;
            result.classList.remove('hidden');
        }

        function loadExample(type) {
            if (type === 'real') {
                textarea.value = "Washington D.C. - The President announced today a comprehensive new economic policy aimed at reducing unemployment and stimulating growth in key sectors. The policy, developed over several months of consultation with economic advisors and industry leaders, includes targeted tax incentives for small businesses, increased infrastructure spending, and new job training programs.";
            } else {
                textarea.value = "SHOCKING DISCOVERY: Scientists report an unverified medical claim. Verify with reliable sources before sharing.";
            }
            charCount.textContent = textarea.value.length + ' characters';
            textarea.focus();
        }
    </script>
</body>
</html>